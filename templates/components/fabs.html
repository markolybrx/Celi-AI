<div class="fixed bottom-6 right-6 flex flex-col items-end gap-4 z-50">
    
    <div id="celi-bubble" 
         class="mr-2 mb-2 bg-white dark:bg-gray-800 text-gray-800 dark:text-gray-200 px-4 py-3 rounded-2xl rounded-tr-sm shadow-lg border border-gray-100 dark:border-gray-700 transform translate-y-4 opacity-0 transition-all duration-500 max-w-[260px] cursor-pointer hidden relative"
         onclick="useBubblePrompt()">
        
        <div onclick="event.stopPropagation(); closeBubble();" class="absolute -top-2 -left-2 bg-gray-200 dark:bg-gray-700 text-gray-500 rounded-full p-1 shadow-sm hover:bg-red-100 hover:text-red-500">
            <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
        </div>

        <p id="celi-bubble-text" class="text-xs font-medium leading-snug">
            Loading signal...
        </p>
    </div>

    <button onclick="openChat('journal')" 
            class="w-14 h-14 rounded-full bg-gradient-to-br from-indigo-500 to-purple-600 text-white shadow-xl hover:scale-105 hover:shadow-2xl transition-all flex items-center justify-center relative group z-50">
        
        <svg class="w-7 h-7" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"></path></svg>
        
        <div class="absolute inset-0 rounded-full border-2 border-white/30 animate-ping opacity-75"></div>
    </button>

</div>

<script>
    // --- DAILY PROMPTS LOGIC ---
    const PROMPTS = [
        "Mission Log: What is the single most important coordinate (task) you need to reach today?",
        "If you could teleport to the end of the day, what would you want to have accomplished?",
        "Identify one obstacle in your orbit today. How will you navigate around it?",
        "System Check: On a scale of 1-10, how heavy is the gravity (stress) you are feeling?",
        "What is one small way you can recharge your shields (rest) this evening?",
        "Scan your recent memory: What is a small victory you forgot to celebrate?",
        "If your anxiety was a physical object floating in space, what would it look like?",
        "What is a 'black hole' thought pattern you keep falling into recently?",
        "Send a message to your past self from 5 years ago. What would you tell them?",
        "What does 'peace' look like in your universe right now?"
    ];

    function loadBubblePrompt() {
        const bubble = document.getElementById('celi-bubble');
        const text = document.getElementById('celi-bubble-text');
        
        // Pick prompt based on Day of Year (Deterministic)
        const dayOfYear = Math.floor((new Date() - new Date(new Date().getFullYear(), 0, 0)) / 1000 / 60 / 60 / 24);
        const prompt = PROMPTS[dayOfYear % PROMPTS.length];
        
        text.innerText = prompt;

        // Show after 2 seconds
        setTimeout(() => {
            if(bubble) {
                bubble.classList.remove('hidden');
                setTimeout(() => bubble.classList.remove('translate-y-4', 'opacity-0'), 10);
            }
        }, 2000);
    }

    function useBubblePrompt() {
        const txt = document.getElementById('celi-bubble-text').innerText;
        document.getElementById('chat-input').value = `[Prompt: ${txt}] \n\n`;
        openChat('journal');
        closeBubble();
        setTimeout(() => document.getElementById('chat-input').focus(), 500);
    }

    function closeBubble() {
        const bubble = document.getElementById('celi-bubble');
        bubble.classList.add('opacity-0', 'translate-y-4');
        setTimeout(() => bubble.classList.add('hidden'), 500);
    }

    // Initialize
    loadBubblePrompt();
</script>
